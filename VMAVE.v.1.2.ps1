CLEAR-HOST
# VMAVE.v.1.2.ps1 <- this is a suggested script file name
# 2021-05-06 - v.1.0:
# 2021-05-10 - v.1.1: Added all NiceHash folders!
# 2021-05-12 - v.1.2: Updated $MFLJ (Master File List from JSON) list; clean-up ExclusionPath's before adding ExclusionProcess's.  Using ExclusionProcess is safer than ExclusionPath - ExclusionPath creates umbreallas that malware could hide under.

# (c) 2021 VaporMiner


$RootFolder = ""
$RootFolder = "C:\CCMN\Miners" # Replace this with the path to your Nicehash folder
# If you are not using all of the miners, remove them from the MFLJ variable
$MFLJ = @(
    "\NiceHash\nhm_windows_3.0.6.5\CreateLogReport.exe",
    "\NiceHash\nhm_windows_3.0.6.5\NiceHashMiner.exe",
    "\NiceHash\nhm_windows_3.0.6.5\runnhmasadmin.exe",
    "\NiceHash\nhm_windows_3.0.6.5\app_3.0.6.5\AmdComputeModeSwitcher.exe",
    "\NiceHash\nhm_windows_3.0.6.5\app_3.0.6.5\app_nhm.exe",
    "\NiceHash\nhm_windows_3.0.6.5\app_3.0.6.5\BouncyCastle.Crypto.dll",
    "\NiceHash\nhm_windows_3.0.6.5\app_3.0.6.5\device_detection.exe",
    "\NiceHash\nhm_windows_3.0.6.5\app_3.0.6.5\device_detection_cpu.dll",
    "\NiceHash\nhm_windows_3.0.6.5\app_3.0.6.5\device_detection_cuda_nvml.dll",
    "\NiceHash\nhm_windows_3.0.6.5\app_3.0.6.5\device_detection_opencl.dll",
    "\NiceHash\nhm_windows_3.0.6.5\app_3.0.6.5\device_monitoring_amd.dll",
    "\NiceHash\nhm_windows_3.0.6.5\app_3.0.6.5\Hardcodet.Wpf.TaskbarNotification.dll",
    "\NiceHash\nhm_windows_3.0.6.5\app_3.0.6.5\log4net.dll",
    "\NiceHash\nhm_windows_3.0.6.5\app_3.0.6.5\ManagedNvml.dll",
    "\NiceHash\nhm_windows_3.0.6.5\app_3.0.6.5\MegaApiClient.dll",
    "\NiceHash\nhm_windows_3.0.6.5\app_3.0.6.5\Microsoft.Toolkit.Wpf.UI.Controls.WebView.dll",
    "\NiceHash\nhm_windows_3.0.6.5\app_3.0.6.5\MinerProcessCounter.exe",
    "\NiceHash\nhm_windows_3.0.6.5\app_3.0.6.5\MyDownloader.Core.dll",
    "\NiceHash\nhm_windows_3.0.6.5\app_3.0.6.5\MyDownloader.Extension.dll",
    "\NiceHash\nhm_windows_3.0.6.5\app_3.0.6.5\Newtonsoft.Json.dll",
    "\NiceHash\nhm_windows_3.0.6.5\app_3.0.6.5\NHM.Common.dll",
    "\NiceHash\nhm_windows_3.0.6.5\app_3.0.6.5\NHM.DeviceDetection.dll",
    "\NiceHash\nhm_windows_3.0.6.5\app_3.0.6.5\NHM.DeviceMonitoring.dll",
    "\NiceHash\nhm_windows_3.0.6.5\app_3.0.6.5\NHM.MinerPlugin.dll",
    "\NiceHash\nhm_windows_3.0.6.5\app_3.0.6.5\NHM.MinerPluginLoader.dll",
    "\NiceHash\nhm_windows_3.0.6.5\app_3.0.6.5\NHM.MinerPluginToolkitV1.dll",
    "\NiceHash\nhm_windows_3.0.6.5\app_3.0.6.5\NHM.MinersDownloader.dll",
    "\NiceHash\nhm_windows_3.0.6.5\app_3.0.6.5\NHM.UUID.dll",
    "\NiceHash\nhm_windows_3.0.6.5\app_3.0.6.5\NHMCore.dll",
    "\NiceHash\nhm_windows_3.0.6.5\app_3.0.6.5\nvidiasetp0state.exe",
    "\NiceHash\nhm_windows_3.0.6.5\app_3.0.6.5\SharpCompress.dll",
    "\NiceHash\nhm_windows_3.0.6.5\app_3.0.6.5\System.Buffers.dll",
    "\NiceHash\nhm_windows_3.0.6.5\app_3.0.6.5\System.Memory.dll",
    "\NiceHash\nhm_windows_3.0.6.5\app_3.0.6.5\System.Numerics.Vectors.dll",
    "\NiceHash\nhm_windows_3.0.6.5\app_3.0.6.5\System.Runtime.CompilerServices.Unsafe.dll",
    "\NiceHash\nhm_windows_3.0.6.5\app_3.0.6.5\websocket-sharp.dll",
    "\NiceHash\nhm_windows_3.0.6.5\app_3.0.6.5\zxing.dll",
    "\NiceHash\nhm_windows_3.0.6.5\app_3.0.6.5\zxing.presentation.dll",
    "\NiceHash\nhm_windows_3.0.6.5\app_3.0.6.5\common\cudart32_80.dll",
    "\NiceHash\nhm_windows_3.0.6.5\app_3.0.6.5\common\cudart64_80.dll",
    "\NiceHash\nhm_windows_3.0.6.5\app_3.0.6.5\common\cudart64_91.dll",
    "\NiceHash\nhm_windows_3.0.6.5\app_3.0.6.5\common\libcurl.dll",
    "\NiceHash\nhm_windows_3.0.6.5\app_3.0.6.5\common\msvcp120.dll",
    "\NiceHash\nhm_windows_3.0.6.5\app_3.0.6.5\common\msvcp140.dll",
    "\NiceHash\nhm_windows_3.0.6.5\app_3.0.6.5\common\msvcr110.dll",
    "\NiceHash\nhm_windows_3.0.6.5\app_3.0.6.5\common\msvcr120.dll",
    "\NiceHash\nhm_windows_3.0.6.5\app_3.0.6.5\common\vcruntime140.dll",
    "\NiceHash\nhm_windows_3.0.6.5\app_3.0.6.5\OpenCL\OpenCL.dll",
    "\NiceHash\nhm_windows_3.0.6.5\miner_plugins\01177a50-94ec-11ea-a64d-17be303ea466\MP.TeamRedMiner.dll",
    "\NiceHash\nhm_windows_3.0.6.5\miner_plugins\01177a50-94ec-11ea-a64d-17be303ea466\bins\16.0\teamredminer-v0.8.1-win\teamredminer.exe",
    "\NiceHash\nhm_windows_3.0.6.5\miner_plugins\01177a50-94ec-11ea-a64d-17be303ea466\bins\16.0\teamredminer-v0.8.1-win\trm_nimiq_proxy-win.exe",
    "\NiceHash\nhm_windows_3.0.6.5\miner_plugins\01177a50-94ec-11ea-a64d-17be303ea466\dlls\16.0\MP.TeamRedMiner.dll",
    "\NiceHash\nhm_windows_3.0.6.5\miner_plugins\0a07d6a0-94ec-11ea-a64d-17be303ea466\MP.WildRig.dll",
    "\NiceHash\nhm_windows_3.0.6.5\miner_plugins\0a07d6a0-94ec-11ea-a64d-17be303ea466\bins\16.0\wildrig.exe",
    "\NiceHash\nhm_windows_3.0.6.5\miner_plugins\0a07d6a0-94ec-11ea-a64d-17be303ea466\dlls\16.0\MP.WildRig.dll",
    "\NiceHash\nhm_windows_3.0.6.5\miner_plugins\0e0a7320-94ec-11ea-a64d-17be303ea466\MP.XMRig.dll",
    "\NiceHash\nhm_windows_3.0.6.5\miner_plugins\0e0a7320-94ec-11ea-a64d-17be303ea466\dlls\15.0\MP.XMRig.dll",
    "\NiceHash\nhm_windows_3.0.6.5\miner_plugins\0e0a7320-94ec-11ea-a64d-17be303ea466\dlls\15.1\MP.XMRig.dll",
    "\NiceHash\nhm_windows_3.0.6.5\miner_plugins\0e0a7320-94ec-11ea-a64d-17be303ea466\dlls\15.6\MP.XMRig.dll",
    "\NiceHash\nhm_windows_3.0.6.5\miner_plugins\0e0a7320-94ec-11ea-a64d-17be303ea466\dlls\15.7\MP.XMRig.dll",
    "\NiceHash\nhm_windows_3.0.6.5\miner_plugins\0e0a7320-94ec-11ea-a64d-17be303ea466\dlls\15.8\MP.XMRig.dll",
    "\NiceHash\nhm_windows_3.0.6.5\miner_plugins\0e0a7320-94ec-11ea-a64d-17be303ea466\dlls\15.9\MP.XMRig.dll",
    "\NiceHash\nhm_windows_3.0.6.5\miner_plugins\0e0a7320-94ec-11ea-a64d-17be303ea466\dlls\16.0\MP.XMRig.dll",
    "\NiceHash\nhm_windows_3.0.6.5\miner_plugins\27315fe0-3b03-11eb-b105-8d43d5bd63be\MP.Excavator.dll",
    "\NiceHash\nhm_windows_3.0.6.5\miner_plugins\27315fe0-3b03-11eb-b105-8d43d5bd63be\dlls\15.0\MP.Excavator.dll",
    "\NiceHash\nhm_windows_3.0.6.5\miner_plugins\27315fe0-3b03-11eb-b105-8d43d5bd63be\dlls\15.1\MP.Excavator.dll",
    "\NiceHash\nhm_windows_3.0.6.5\miner_plugins\27315fe0-3b03-11eb-b105-8d43d5bd63be\dlls\15.10\MP.Excavator.dll",
    "\NiceHash\nhm_windows_3.0.6.5\miner_plugins\27315fe0-3b03-11eb-b105-8d43d5bd63be\dlls\15.11\MP.Excavator.dll",
    "\NiceHash\nhm_windows_3.0.6.5\miner_plugins\27315fe0-3b03-11eb-b105-8d43d5bd63be\dlls\15.2\MP.Excavator.dll",
    "\NiceHash\nhm_windows_3.0.6.5\miner_plugins\27315fe0-3b03-11eb-b105-8d43d5bd63be\dlls\15.4\MP.Excavator.dll",
    "\NiceHash\nhm_windows_3.0.6.5\miner_plugins\27315fe0-3b03-11eb-b105-8d43d5bd63be\dlls\15.5\MP.Excavator.dll",
    "\NiceHash\nhm_windows_3.0.6.5\miner_plugins\27315fe0-3b03-11eb-b105-8d43d5bd63be\dlls\15.6\MP.Excavator.dll",
    "\NiceHash\nhm_windows_3.0.6.5\miner_plugins\27315fe0-3b03-11eb-b105-8d43d5bd63be\dlls\15.7\MP.Excavator.dll",
    "\NiceHash\nhm_windows_3.0.6.5\miner_plugins\27315fe0-3b03-11eb-b105-8d43d5bd63be\dlls\15.8\MP.Excavator.dll",
    "\NiceHash\nhm_windows_3.0.6.5\miner_plugins\27315fe0-3b03-11eb-b105-8d43d5bd63be\dlls\15.9\MP.Excavator.dll",
    "\NiceHash\nhm_windows_3.0.6.5\miner_plugins\27315fe0-3b03-11eb-b105-8d43d5bd63be\dlls\16.0\MP.Excavator.dll",
    "\NiceHash\nhm_windows_3.0.6.5\miner_plugins\e7a58030-94eb-11ea-a64d-17be303ea466\bins\16.1\miner.exe",
    "\NiceHash\nhm_windows_3.0.6.5\miner_plugins\e7a58030-94eb-11ea-a64d-17be303ea466\dlls\16.1\MP.GMiner.dll",
    "\NiceHash\nhm_windows_3.0.6.5\miner_plugins\eb75e920-94eb-11ea-a64d-17be303ea466\MP.LolMiner.dll",
    "\NiceHash\nhm_windows_3.0.6.5\miner_plugins\eb75e920-94eb-11ea-a64d-17be303ea466\bins\16.0\1.21\lolMiner.exe",
    "\NiceHash\nhm_windows_3.0.6.5\miner_plugins\eb75e920-94eb-11ea-a64d-17be303ea466\dlls\15.0\MP.LolMiner.dll",
    "\NiceHash\nhm_windows_3.0.6.5\miner_plugins\eb75e920-94eb-11ea-a64d-17be303ea466\dlls\15.1\MP.LolMiner.dll",
    "\NiceHash\nhm_windows_3.0.6.5\miner_plugins\eb75e920-94eb-11ea-a64d-17be303ea466\dlls\15.2\MP.LolMiner.dll",
    "\NiceHash\nhm_windows_3.0.6.5\miner_plugins\eb75e920-94eb-11ea-a64d-17be303ea466\dlls\15.3\MP.LolMiner.dll",
    "\NiceHash\nhm_windows_3.0.6.5\miner_plugins\eb75e920-94eb-11ea-a64d-17be303ea466\dlls\15.4\MP.LolMiner.dll",
    "\NiceHash\nhm_windows_3.0.6.5\miner_plugins\eb75e920-94eb-11ea-a64d-17be303ea466\dlls\15.5\MP.LolMiner.dll",
    "\NiceHash\nhm_windows_3.0.6.5\miner_plugins\eb75e920-94eb-11ea-a64d-17be303ea466\dlls\15.6\MP.LolMiner.dll",
    "\NiceHash\nhm_windows_3.0.6.5\miner_plugins\eb75e920-94eb-11ea-a64d-17be303ea466\dlls\15.7\MP.LolMiner.dll",
    "\NiceHash\nhm_windows_3.0.6.5\miner_plugins\eb75e920-94eb-11ea-a64d-17be303ea466\dlls\16.0\MP.LolMiner.dll",
    "\NiceHash\nhm_windows_3.0.6.5\miner_plugins\f25fee20-94eb-11ea-a64d-17be303ea466\MP.NanoMiner.dll",
    "\NiceHash\nhm_windows_3.0.6.5\miner_plugins\f25fee20-94eb-11ea-a64d-17be303ea466\bins\16.0\nanominer-windows-3.3.4-cuda11\nanominer.exe",
    "\NiceHash\nhm_windows_3.0.6.5\miner_plugins\f25fee20-94eb-11ea-a64d-17be303ea466\bins\16.0\nanominer-windows-3.3.4-cuda11\nvrtc-builtins64_111.dll",
    "\NiceHash\nhm_windows_3.0.6.5\miner_plugins\f25fee20-94eb-11ea-a64d-17be303ea466\bins\16.0\nanominer-windows-3.3.4-cuda11\nvrtc64_111_0.dll",
    "\NiceHash\nhm_windows_3.0.6.5\miner_plugins\f25fee20-94eb-11ea-a64d-17be303ea466\bins\16.0\nanominer-windows-3.3.4-cuda11\service.dll",
    "\NiceHash\nhm_windows_3.0.6.5\miner_plugins\f25fee20-94eb-11ea-a64d-17be303ea466\bins\16.0\nanominer-windows-3.3.4-cuda11\WinAMDTweak\EIO.dll",
    "\NiceHash\nhm_windows_3.0.6.5\miner_plugins\f25fee20-94eb-11ea-a64d-17be303ea466\bins\16.0\nanominer-windows-3.3.4-cuda11\WinAMDTweak\WinAMDTweak.exe",
    "\NiceHash\nhm_windows_3.0.6.5\miner_plugins\f25fee20-94eb-11ea-a64d-17be303ea466\dlls\16.0\MP.NanoMiner.dll",
    "\NiceHash\nhm_windows_3.0.6.5\miner_plugins\f683f550-94eb-11ea-a64d-17be303ea466\MP.NBMiner.dll",
    "\NiceHash\nhm_windows_3.0.6.5\miner_plugins\f683f550-94eb-11ea-a64d-17be303ea466\bins\16.0\NBMiner_Win\nbminer.exe",
    "\NiceHash\nhm_windows_3.0.6.5\miner_plugins\f683f550-94eb-11ea-a64d-17be303ea466\bins\16.1\NBMiner_Win\nbminer.exe",
    "\NiceHash\nhm_windows_3.0.6.5\miner_plugins\f683f550-94eb-11ea-a64d-17be303ea466\dlls\15.0\MP.NBMiner.dll",
    "\NiceHash\nhm_windows_3.0.6.5\miner_plugins\f683f550-94eb-11ea-a64d-17be303ea466\dlls\15.1\MP.NBMiner.dll",
    "\NiceHash\nhm_windows_3.0.6.5\miner_plugins\f683f550-94eb-11ea-a64d-17be303ea466\dlls\15.10\MP.NBMiner.dll",
    "\NiceHash\nhm_windows_3.0.6.5\miner_plugins\f683f550-94eb-11ea-a64d-17be303ea466\dlls\15.2\MP.NBMiner.dll",
    "\NiceHash\nhm_windows_3.0.6.5\miner_plugins\f683f550-94eb-11ea-a64d-17be303ea466\dlls\15.3\MP.NBMiner.dll",
    "\NiceHash\nhm_windows_3.0.6.5\miner_plugins\f683f550-94eb-11ea-a64d-17be303ea466\dlls\15.4\MP.NBMiner.dll",
    "\NiceHash\nhm_windows_3.0.6.5\miner_plugins\f683f550-94eb-11ea-a64d-17be303ea466\dlls\15.5\MP.NBMiner.dll",
    "\NiceHash\nhm_windows_3.0.6.5\miner_plugins\f683f550-94eb-11ea-a64d-17be303ea466\dlls\15.6\MP.NBMiner.dll",
    "\NiceHash\nhm_windows_3.0.6.5\miner_plugins\f683f550-94eb-11ea-a64d-17be303ea466\dlls\15.7\MP.NBMiner.dll",
    "\NiceHash\nhm_windows_3.0.6.5\miner_plugins\f683f550-94eb-11ea-a64d-17be303ea466\dlls\15.8\MP.NBMiner.dll",
    "\NiceHash\nhm_windows_3.0.6.5\miner_plugins\f683f550-94eb-11ea-a64d-17be303ea466\dlls\15.9\MP.NBMiner.dll",
    "\NiceHash\nhm_windows_3.0.6.5\miner_plugins\f683f550-94eb-11ea-a64d-17be303ea466\dlls\16.0\MP.NBMiner.dll",
    "\NiceHash\nhm_windows_3.0.6.5\miner_plugins\f683f550-94eb-11ea-a64d-17be303ea466\dlls\16.1\MP.NBMiner.dll",
    "\NiceHash\nhm_windows_3.0.6.5\miner_plugins\fd45fff0-94eb-11ea-a64d-17be303ea466\bins\16.0\SRBMiner-Multi-0-6-0\SRBMiner-MULTI.exe",
    "\NiceHash\nhm_windows_3.0.6.5\miner_plugins\fd45fff0-94eb-11ea-a64d-17be303ea466\bins\16.0\SRBMiner-Multi-0-6-0\Devcon\devcon.exe",
    "\NiceHash\nhm_windows_3.0.6.5\miner_plugins\fd45fff0-94eb-11ea-a64d-17be303ea466\bins\16.0\SRBMiner-Multi-0-6-0\SRBMULTI-Restarter\SRBMULTI-Restarter.exe",
    "\NiceHash\nhm_windows_3.0.6.5\miner_plugins\fd45fff0-94eb-11ea-a64d-17be303ea466\dlls\16.0\MP.SRBMiner.dll",
    "\NiceHash\nhm_windows_3.0.6.5\miner_plugins\VC_REDIST_x64_2015_2019\bins\1.0\VC_redist.x64_2015_2019.exe",
    "\NiceHash\CreateLogReport.exe",
    "\NiceHash\NiceHashMiner.exe",
    "\NiceHash\runnhmasadmin.exe",
    "\NiceHash\app_3.0.6.5\AmdComputeModeSwitcher.exe",
    "\NiceHash\app_3.0.6.5\app_nhm.exe",
    "\NiceHash\app_3.0.6.5\BouncyCastle.Crypto.dll",
    "\NiceHash\app_3.0.6.5\device_detection.exe",
    "\NiceHash\app_3.0.6.5\device_detection_cpu.dll",
    "\NiceHash\app_3.0.6.5\device_detection_cuda_nvml.dll",
    "\NiceHash\app_3.0.6.5\device_detection_opencl.dll",
    "\NiceHash\app_3.0.6.5\device_monitoring_amd.dll",
    "\NiceHash\app_3.0.6.5\Hardcodet.Wpf.TaskbarNotification.dll",
    "\NiceHash\app_3.0.6.5\log4net.dll",
    "\NiceHash\app_3.0.6.5\ManagedNvml.dll",
    "\NiceHash\app_3.0.6.5\MegaApiClient.dll",
    "\NiceHash\app_3.0.6.5\Microsoft.Toolkit.Wpf.UI.Controls.WebView.dll",
    "\NiceHash\app_3.0.6.5\MinerProcessCounter.exe",
    "\NiceHash\app_3.0.6.5\MyDownloader.Core.dll",
    "\NiceHash\app_3.0.6.5\MyDownloader.Extension.dll",
    "\NiceHash\app_3.0.6.5\Newtonsoft.Json.dll",
    "\NiceHash\app_3.0.6.5\NHM.Common.dll",
    "\NiceHash\app_3.0.6.5\NHM.DeviceDetection.dll",
    "\NiceHash\app_3.0.6.5\NHM.DeviceMonitoring.dll",
    "\NiceHash\app_3.0.6.5\NHM.MinerPlugin.dll",
    "\NiceHash\app_3.0.6.5\NHM.MinerPluginLoader.dll",
    "\NiceHash\app_3.0.6.5\NHM.MinerPluginToolkitV1.dll",
    "\NiceHash\app_3.0.6.5\NHM.MinersDownloader.dll",
    "\NiceHash\app_3.0.6.5\NHM.UUID.dll",
    "\NiceHash\app_3.0.6.5\NHMCore.dll",
    "\NiceHash\app_3.0.6.5\nvidiasetp0state.exe",
    "\NiceHash\app_3.0.6.5\SharpCompress.dll",
    "\NiceHash\app_3.0.6.5\System.Buffers.dll",
    "\NiceHash\app_3.0.6.5\System.Memory.dll",
    "\NiceHash\app_3.0.6.5\System.Numerics.Vectors.dll",
    "\NiceHash\app_3.0.6.5\System.Runtime.CompilerServices.Unsafe.dll",
    "\NiceHash\app_3.0.6.5\websocket-sharp.dll",
    "\NiceHash\app_3.0.6.5\zxing.dll",
    "\NiceHash\app_3.0.6.5\zxing.presentation.dll",
    "\NiceHash\app_3.0.6.5\common\cudart32_80.dll",
    "\NiceHash\app_3.0.6.5\common\cudart64_80.dll",
    "\NiceHash\app_3.0.6.5\common\cudart64_91.dll",
    "\NiceHash\app_3.0.6.5\common\libcurl.dll",
    "\NiceHash\app_3.0.6.5\common\msvcp120.dll",
    "\NiceHash\app_3.0.6.5\common\msvcp140.dll",
    "\NiceHash\app_3.0.6.5\common\msvcr110.dll",
    "\NiceHash\app_3.0.6.5\common\msvcr120.dll",
    "\NiceHash\app_3.0.6.5\common\vcruntime140.dll",
    "\NiceHash\app_3.0.6.5\OpenCL\OpenCL.dll",
    "\NiceHash\miner_plugins\01177a50-94ec-11ea-a64d-17be303ea466\MP.TeamRedMiner.dll",
    "\NiceHash\miner_plugins\01177a50-94ec-11ea-a64d-17be303ea466\bins\16.0\teamredminer-v0.8.1-win\teamredminer.exe",
    "\NiceHash\miner_plugins\01177a50-94ec-11ea-a64d-17be303ea466\bins\16.0\teamredminer-v0.8.1-win\trm_nimiq_proxy-win.exe",
    "\NiceHash\miner_plugins\01177a50-94ec-11ea-a64d-17be303ea466\dlls\16.0\MP.TeamRedMiner.dll",
    "\NiceHash\miner_plugins\0a07d6a0-94ec-11ea-a64d-17be303ea466\MP.WildRig.dll",
    "\NiceHash\miner_plugins\0a07d6a0-94ec-11ea-a64d-17be303ea466\bins\16.0\wildrig.exe",
    "\NiceHash\miner_plugins\0a07d6a0-94ec-11ea-a64d-17be303ea466\dlls\16.0\MP.WildRig.dll",
    "\NiceHash\miner_plugins\0e0a7320-94ec-11ea-a64d-17be303ea466\MP.XMRig.dll",
    "\NiceHash\miner_plugins\0e0a7320-94ec-11ea-a64d-17be303ea466\dlls\15.0\MP.XMRig.dll",
    "\NiceHash\miner_plugins\0e0a7320-94ec-11ea-a64d-17be303ea466\dlls\15.1\MP.XMRig.dll",
    "\NiceHash\miner_plugins\0e0a7320-94ec-11ea-a64d-17be303ea466\dlls\15.6\MP.XMRig.dll",
    "\NiceHash\miner_plugins\0e0a7320-94ec-11ea-a64d-17be303ea466\dlls\15.7\MP.XMRig.dll",
    "\NiceHash\miner_plugins\0e0a7320-94ec-11ea-a64d-17be303ea466\dlls\15.8\MP.XMRig.dll",
    "\NiceHash\miner_plugins\0e0a7320-94ec-11ea-a64d-17be303ea466\dlls\15.9\MP.XMRig.dll",
    "\NiceHash\miner_plugins\0e0a7320-94ec-11ea-a64d-17be303ea466\dlls\16.0\MP.XMRig.dll",
    "\NiceHash\miner_plugins\27315fe0-3b03-11eb-b105-8d43d5bd63be\MP.Excavator.dll",
    "\NiceHash\miner_plugins\27315fe0-3b03-11eb-b105-8d43d5bd63be\dlls\15.0\MP.Excavator.dll",
    "\NiceHash\miner_plugins\27315fe0-3b03-11eb-b105-8d43d5bd63be\dlls\15.1\MP.Excavator.dll",
    "\NiceHash\miner_plugins\27315fe0-3b03-11eb-b105-8d43d5bd63be\dlls\15.10\MP.Excavator.dll",
    "\NiceHash\miner_plugins\27315fe0-3b03-11eb-b105-8d43d5bd63be\dlls\15.11\MP.Excavator.dll",
    "\NiceHash\miner_plugins\27315fe0-3b03-11eb-b105-8d43d5bd63be\dlls\15.2\MP.Excavator.dll",
    "\NiceHash\miner_plugins\27315fe0-3b03-11eb-b105-8d43d5bd63be\dlls\15.4\MP.Excavator.dll",
    "\NiceHash\miner_plugins\27315fe0-3b03-11eb-b105-8d43d5bd63be\dlls\15.5\MP.Excavator.dll",
    "\NiceHash\miner_plugins\27315fe0-3b03-11eb-b105-8d43d5bd63be\dlls\15.6\MP.Excavator.dll",
    "\NiceHash\miner_plugins\27315fe0-3b03-11eb-b105-8d43d5bd63be\dlls\15.7\MP.Excavator.dll",
    "\NiceHash\miner_plugins\27315fe0-3b03-11eb-b105-8d43d5bd63be\dlls\15.8\MP.Excavator.dll",
    "\NiceHash\miner_plugins\27315fe0-3b03-11eb-b105-8d43d5bd63be\dlls\15.9\MP.Excavator.dll",
    "\NiceHash\miner_plugins\27315fe0-3b03-11eb-b105-8d43d5bd63be\dlls\16.0\MP.Excavator.dll",
    "\NiceHash\miner_plugins\e7a58030-94eb-11ea-a64d-17be303ea466\bins\16.1\miner.exe",
    "\NiceHash\miner_plugins\e7a58030-94eb-11ea-a64d-17be303ea466\dlls\16.1\MP.GMiner.dll",
    "\NiceHash\miner_plugins\eb75e920-94eb-11ea-a64d-17be303ea466\MP.LolMiner.dll",
    "\NiceHash\miner_plugins\eb75e920-94eb-11ea-a64d-17be303ea466\bins\16.0\1.21\lolMiner.exe",
    "\NiceHash\miner_plugins\eb75e920-94eb-11ea-a64d-17be303ea466\dlls\15.0\MP.LolMiner.dll",
    "\NiceHash\miner_plugins\eb75e920-94eb-11ea-a64d-17be303ea466\dlls\15.1\MP.LolMiner.dll",
    "\NiceHash\miner_plugins\eb75e920-94eb-11ea-a64d-17be303ea466\dlls\15.2\MP.LolMiner.dll",
    "\NiceHash\miner_plugins\eb75e920-94eb-11ea-a64d-17be303ea466\dlls\15.3\MP.LolMiner.dll",
    "\NiceHash\miner_plugins\eb75e920-94eb-11ea-a64d-17be303ea466\dlls\15.4\MP.LolMiner.dll",
    "\NiceHash\miner_plugins\eb75e920-94eb-11ea-a64d-17be303ea466\dlls\15.5\MP.LolMiner.dll",
    "\NiceHash\miner_plugins\eb75e920-94eb-11ea-a64d-17be303ea466\dlls\15.6\MP.LolMiner.dll",
    "\NiceHash\miner_plugins\eb75e920-94eb-11ea-a64d-17be303ea466\dlls\15.7\MP.LolMiner.dll",
    "\NiceHash\miner_plugins\eb75e920-94eb-11ea-a64d-17be303ea466\dlls\16.0\MP.LolMiner.dll",
    "\NiceHash\miner_plugins\f25fee20-94eb-11ea-a64d-17be303ea466\MP.NanoMiner.dll",
    "\NiceHash\miner_plugins\f25fee20-94eb-11ea-a64d-17be303ea466\bins\16.0\nanominer-windows-3.3.4-cuda11\nanominer.exe",
    "\NiceHash\miner_plugins\f25fee20-94eb-11ea-a64d-17be303ea466\bins\16.0\nanominer-windows-3.3.4-cuda11\nvrtc-builtins64_111.dll",
    "\NiceHash\miner_plugins\f25fee20-94eb-11ea-a64d-17be303ea466\bins\16.0\nanominer-windows-3.3.4-cuda11\nvrtc64_111_0.dll",
    "\NiceHash\miner_plugins\f25fee20-94eb-11ea-a64d-17be303ea466\bins\16.0\nanominer-windows-3.3.4-cuda11\service.dll",
    "\NiceHash\miner_plugins\f25fee20-94eb-11ea-a64d-17be303ea466\bins\16.0\nanominer-windows-3.3.4-cuda11\WinAMDTweak\EIO.dll",
    "\NiceHash\miner_plugins\f25fee20-94eb-11ea-a64d-17be303ea466\bins\16.0\nanominer-windows-3.3.4-cuda11\WinAMDTweak\WinAMDTweak.exe",
    "\NiceHash\miner_plugins\f25fee20-94eb-11ea-a64d-17be303ea466\dlls\16.0\MP.NanoMiner.dll",
    "\NiceHash\miner_plugins\f683f550-94eb-11ea-a64d-17be303ea466\MP.NBMiner.dll",
    "\NiceHash\miner_plugins\f683f550-94eb-11ea-a64d-17be303ea466\bins\16.0\NBMiner_Win\nbminer.exe",
    "\NiceHash\miner_plugins\f683f550-94eb-11ea-a64d-17be303ea466\bins\16.1\NBMiner_Win\nbminer.exe",
    "\NiceHash\miner_plugins\f683f550-94eb-11ea-a64d-17be303ea466\dlls\15.0\MP.NBMiner.dll",
    "\NiceHash\miner_plugins\f683f550-94eb-11ea-a64d-17be303ea466\dlls\15.1\MP.NBMiner.dll",
    "\NiceHash\miner_plugins\f683f550-94eb-11ea-a64d-17be303ea466\dlls\15.10\MP.NBMiner.dll",
    "\NiceHash\miner_plugins\f683f550-94eb-11ea-a64d-17be303ea466\dlls\15.2\MP.NBMiner.dll",
    "\NiceHash\miner_plugins\f683f550-94eb-11ea-a64d-17be303ea466\dlls\15.3\MP.NBMiner.dll",
    "\NiceHash\miner_plugins\f683f550-94eb-11ea-a64d-17be303ea466\dlls\15.4\MP.NBMiner.dll",
    "\NiceHash\miner_plugins\f683f550-94eb-11ea-a64d-17be303ea466\dlls\15.5\MP.NBMiner.dll",
    "\NiceHash\miner_plugins\f683f550-94eb-11ea-a64d-17be303ea466\dlls\15.6\MP.NBMiner.dll",
    "\NiceHash\miner_plugins\f683f550-94eb-11ea-a64d-17be303ea466\dlls\15.7\MP.NBMiner.dll",
    "\NiceHash\miner_plugins\f683f550-94eb-11ea-a64d-17be303ea466\dlls\15.8\MP.NBMiner.dll",
    "\NiceHash\miner_plugins\f683f550-94eb-11ea-a64d-17be303ea466\dlls\15.9\MP.NBMiner.dll",
    "\NiceHash\miner_plugins\f683f550-94eb-11ea-a64d-17be303ea466\dlls\16.0\MP.NBMiner.dll",
    "\NiceHash\miner_plugins\f683f550-94eb-11ea-a64d-17be303ea466\dlls\16.1\MP.NBMiner.dll",
    "\NiceHash\miner_plugins\fd45fff0-94eb-11ea-a64d-17be303ea466\bins\16.0\SRBMiner-Multi-0-6-0\SRBMiner-MULTI.exe",
    "\NiceHash\miner_plugins\fd45fff0-94eb-11ea-a64d-17be303ea466\bins\16.0\SRBMiner-Multi-0-6-0\Devcon\devcon.exe",
    "\NiceHash\miner_plugins\fd45fff0-94eb-11ea-a64d-17be303ea466\bins\16.0\SRBMiner-Multi-0-6-0\SRBMULTI-Restarter\SRBMULTI-Restarter.exe",
    "\NiceHash\miner_plugins\fd45fff0-94eb-11ea-a64d-17be303ea466\dlls\16.0\MP.SRBMiner.dll",
    "\NiceHash\miner_plugins\VC_REDIST_x64_2015_2019\bins\1.0\VC_redist.x64_2015_2019.exe"
)
$ExclusionProcess = @()
$ExclusionProcess = (Get-MpPreference).ExclusionProcess
$Detected = @()
$Detected = (Get-mpthreatdetection).ProcessName
If ($NULL -ne $Detected)
{
    $Detected | %{If (($_ -notin $MFLJ) -and ($_ -notin $ExclusionProcess)){$MFLJ += $_}}
}
$ExclusionPath = @()
$ExclusionPath = (Get-MpPreference).ExclusionPath
IF (Test-Path "\NiceHash\nhm_windows_3.0.6.5")
{
    $ExclusionPath | %{If ($_ -match "NiceHash"){Remove-MpPreference -ExclusionPath $_ }}
    $MFLJ | Where-Object {(([string]::Contact($RootFolder,$_)) -notin $ExclusionProcess)} | Where-Object {$_ -like "\NiceHash\nhm_windows_3.0.6.5*"} | %{Add-MpPreference -ExclusionProcess ([string]::Contact($RootFolder,$_)) -Force}
}
Else
{
    $ExclusionPath | %{If ($_ -match "NiceHash"){Remove-MpPreference -ExclusionPath $_}}
    $MFLJ | Where-Object {($_ -notin $ExclusionProcess)} | Where-Object {$_ -notlike "*nhm_windows_3.0.6.5*"} | %{Add-MpPreference -ExclusionProcess ([string]::Contact($RootFolder,$_)) -Force}
}
